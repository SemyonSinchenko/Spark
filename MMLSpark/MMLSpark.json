{"paragraphs":[{"text":"%spark.dep\nz.addRepo(\"bintray.com\").url(\"http://dl.bintray.com/spark-packages/maven/\")\nz.load(\"Azure:mmlspark:0.17\")","user":"anonymous","dateUpdated":"2019-06-18T20:32:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@6b777876\n"}]},"apps":[],"jobName":"paragraph_1560874924550_-1188854186","id":"20190516-142409_1508533848","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25882"},{"text":"import com.microsoft.ml.spark.SummarizeData\nimport com.microsoft.ml.spark.UDFTransformer\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._","user":"anonymous","dateUpdated":"2019-06-18T20:32:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.microsoft.ml.spark.SummarizeData\nimport com.microsoft.ml.spark.UDFTransformer\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n"}]},"apps":[],"jobName":"paragraph_1560874924559_147762302","id":"20190516-142444_1199755606","dateCreated":"2019-06-18T16:22:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25883","dateFinished":"2019-06-18T20:32:10+0000","dateStarted":"2019-06-18T20:32:10+0000"},{"text":"val titanicSchema = StructType(\n    StructField(\"Passanger\", ShortType) :: StructField(\"Survived\", ShortType) :: StructField(\"PClass\", ShortType) :: StructField(\"Name\", StringType) ::\n    StructField(\"Sex\", StringType) :: StructField(\"Age\", ShortType) :: StructField(\"SibSp\", ShortType) :: StructField(\"Parch\", ShortType) ::\n    StructField(\"Ticket\", StringType) :: StructField(\"Fare\", FloatType) :: StructField(\"Cabin\", StringType) :: StructField(\"Embarked\", StringType) :: Nil\n)","user":"anonymous","dateUpdated":"2019-06-18T20:32:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"titanicSchema: org.apache.spark.sql.types.StructType = StructType(StructField(Passanger,ShortType,true), StructField(Survived,ShortType,true), StructField(PClass,ShortType,true), StructField(Name,StringType,true), StructField(Sex,StringType,true), StructField(Age,ShortType,true), StructField(SibSp,ShortType,true), StructField(Parch,ShortType,true), StructField(Ticket,StringType,true), StructField(Fare,FloatType,true), StructField(Cabin,StringType,true), StructField(Embarked,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1560874924560_-1359318103","id":"20190516-143320_1626806842","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25884"},{"text":"val train = spark\n    .read\n    .schema(titanicSchema)\n    .option(\"header\", true)\n    .csv(\"/mountV/titanic/train.csv\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"train: org.apache.spark.sql.DataFrame = [Passanger: smallint, Survived: smallint ... 10 more fields]\n"}]},"apps":[],"jobName":"paragraph_1560874924561_-107313033","id":"20190615-170745_651573283","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25885"},{"text":"println(s\"Train shape is: ${train.count} x ${train.columns.length}\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Train shape is: 891 x 12\n"}]},"apps":[],"jobName":"paragraph_1560874924561_-1203874762","id":"20190617-141827_977554555","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25886"},{"text":"train.limit(5).createOrReplaceTempView(\"trainHead\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560874924562_-339535666","id":"20190615-171034_1756594776","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25887"},{"text":"%sql\nselect * from trainHead","user":"anonymous","dateUpdated":"2019-06-18T20:31:49+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Passanger":"string","Survived":"string","PClass":"string","Name":"string","Sex":"string","Age":"string","SibSp":"string","Parch":"string","Ticket":"string","Fare":"string","Cabin":"string","Embarked":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Passanger\tSurvived\tPClass\tName\tSex\tAge\tSibSp\tParch\tTicket\tFare\tCabin\tEmbarked\n1\t0\t3\tBraund, Mr. Owen Harris\tmale\t22\t1\t0\tA/5 21171\t7.25\tnull\tS\n2\t1\t1\tCumings, Mrs. John Bradley (Florence Briggs Thayer)\tfemale\t38\t1\t0\tPC 17599\t71.2833\tC85\tC\n3\t1\t3\tHeikkinen, Miss. Laina\tfemale\t26\t0\t0\tSTON/O2. 3101282\t7.925\tnull\tS\n4\t1\t1\tFutrelle, Mrs. Jacques Heath (Lily May Peel)\tfemale\t35\t1\t0\t113803\t53.1\tC123\tS\n5\t0\t3\tAllen, Mr. William Henry\tmale\t35\t0\t0\t373450\t8.05\tnull\tS\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1560874924563_326454169","id":"20190617-085717_1724014834","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25888"},{"text":"new SummarizeData()\n    .setBasic(true)\n    .setCounts(true)\n    .setPercentiles(false)\n    .setSample(true)\n    .setErrorThreshold(0.25)\n    .transform(train)\n    .createOrReplaceTempView(\"summary\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560874924564_-221985823","id":"20190615-171213_391194357","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25889"},{"text":"%sql\nselect * from summary","user":"anonymous","dateUpdated":"2019-06-18T20:31:41+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Feature","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Count","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Unique Value Count","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Missing Value Count","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Min","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"1st Quartile","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Median","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"3rd Quartile","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Max","visible":true,"width":150,"sort":{},"filters":[{}],"pinned":""},{"name":"Sample Variance","visible":true,"width":173,"sort":{},"filters":[{}],"pinned":""},{"name":"Sample Standard Deviation","visible":true,"width":250,"sort":{},"filters":[{}],"pinned":""},{"name":"Sample Skewness","visible":true,"width":213,"sort":{},"filters":[{}],"pinned":""},{"name":"Sample Kurtosis","visible":true,"width":195,"sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Feature":"string","Count":"string","Unique Value Count":"string","Missing Value Count":"string","Min":"string","1st Quartile":"string","Median":"string","3rd Quartile":"string","Max":"string","Sample Variance":"string","Sample Standard Deviation":"string","Sample Skewness":"string","Sample Kurtosis":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Feature\tCount\tUnique Value Count\tMissing Value Count\tMin\t1st Quartile\tMedian\t3rd Quartile\tMax\tSample Variance\tSample Standard Deviation\tSample Skewness\tSample Kurtosis\nPassanger\t866.0\t868.0\t25.0\t1.0\t1.0\t230.0\t891.0\t891.0\t65729.45234484517\t256.37755819268807\t-0.009233451403418936\t-1.1809833514491341\nSurvived\t866.0\t2.0\t25.0\t0.0\t0.0\t0.0\t1.0\t1.0\t0.23720514223925043\t0.4870371056082385\t0.4697168510173608\t-1.7793660798703366\nPClass\t866.0\t3.0\t25.0\t1.0\t1.0\t2.0\t3.0\t3.0\t0.7051328945787554\t0.8397219150282761\t-0.6110847433240213\t-1.3082943286173574\nName\t866.0\t919.0\t25.0\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\nSex\t866.0\t2.0\t25.0\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\nAge\t689.0\t70.0\t202.0\t1.0\t1.0\t21.0\t80.0\t80.0\t204.9956374253212\t14.317668714749662\t0.4281582695969908\t0.1718857559206337\nSibSp\t866.0\t7.0\t25.0\t0.0\t0.0\t0.0\t8.0\t8.0\t1.2391154600915784\t1.1131556315680113\t3.6738998754994885\t17.515361819520823\nParch\t866.0\t7.0\t25.0\t0.0\t0.0\t0.0\t6.0\t6.0\t0.6514744556728831\t0.8071396754421648\t2.789420805324004\t9.991884711754812\nTicket\t866.0\t675.0\t25.0\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\nFare\t866.0\t241.0\t25.0\t0.0\t0.0\t7.925000190734863\t512.3292236328125\t512.3292236328125\t2513.3192846471047\t50.13301591413691\t4.753548242605805\t32.78424671746155\nCabin\t200.0\t149.0\t691.0\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\nEmbarked\t864.0\t3.0\t27.0\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\tNaN\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1560874924564_-1191304612","id":"20190617-085255_1078627546","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25890"},{"text":"val trainFiltered = train.filter(!(isnan(col(\"Survived\")) || isnull(col(\"Survived\"))))","user":"anonymous","dateUpdated":"2019-06-18T20:31:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainFiltered: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Passanger: smallint, Survived: smallint ... 10 more fields]\n"}]},"apps":[],"jobName":"paragraph_1560874924565_-583310099","id":"20190617-181729_1283862353","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25891"},{"text":"val miss = \".*miss\\\\..*\".r\nval mr = \".*mr\\\\..*\".r\nval mrs = \".*mrs\\\\..*\".r\nval master = \".*master.*\".r\n\ndef convertNames(input: String): Option[String] = {\n    Option(input).map(x => {\n        x.toLowerCase match {\n            case miss() => \"Miss\"\n            case mr() => \"Mr\"\n            case mrs() => \"Mrs\"\n            case master() => \"Master\"\n            case _ => \"Unknown\"\n        }\n    })\n}","user":"anonymous","dateUpdated":"2019-06-18T20:31:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"miss: scala.util.matching.Regex = .*miss\\..*\nmr: scala.util.matching.Regex = .*mr\\..*\nmrs: scala.util.matching.Regex = .*mrs\\..*\nmaster: scala.util.matching.Regex = .*master.*\nconvertNames: (input: String)Option[String]\n"}]},"apps":[],"jobName":"paragraph_1560874924576_166081889","id":"20190615-171935_1223485131","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25892"},{"text":"trainFiltered.select(col(\"Name\")).take(5).foreach(x => println(x + \" -> \" + convertNames(x.getString(0))))","user":"anonymous","dateUpdated":"2019-06-18T20:31:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Braund, Mr. Owen Harris] -> Some(Mr)\n[Cumings, Mrs. John Bradley (Florence Briggs Thayer)] -> Some(Mrs)\n[Heikkinen, Miss. Laina] -> Some(Miss)\n[Futrelle, Mrs. Jacques Heath (Lily May Peel)] -> Some(Mrs)\n[Allen, Mr. William Henry] -> Some(Mr)\n"}]},"apps":[],"jobName":"paragraph_1560874924577_-1724321468","id":"20190617-093903_1285584320","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25893"},{"text":"val nameTransformUDF = udf(convertNames _)\n\nval nameTransformer = new UDFTransformer()\n    .setUDF(nameTransformUDF)\n    .setInputCol(\"Name\")\n    .setOutputCol(\"NameType\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"nameTransformUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\nnameTransformer: com.microsoft.ml.spark.UDFTransformer = UDFTransformer_1022079b1e58\n"}]},"apps":[],"jobName":"paragraph_1560874924578_1066492767","id":"20190617-094715_1349253246","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25894"},{"text":"trainFiltered.select(col(\"Cabin\")).show","user":"anonymous","dateUpdated":"2019-06-18T20:31:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+\n|Cabin|\n+-----+\n| null|\n|  C85|\n| null|\n| C123|\n| null|\n| null|\n|  E46|\n| null|\n| null|\n| null|\n|   G6|\n| C103|\n| null|\n| null|\n| null|\n| null|\n| null|\n| null|\n| null|\n| null|\n+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1560874924578_2076174016","id":"20190617-180413_386085863","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25895"},{"text":"trainFiltered.groupBy(\"Cabin\").agg(count(\"Passanger\").alias(\"count\")).sort(desc(\"count\")).show(5)","user":"anonymous","dateUpdated":"2019-06-18T20:31:19+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|      Cabin|count|\n+-----------+-----+\n|       null|  687|\n|         G6|    4|\n|    B96 B98|    4|\n|C23 C25 C27|    4|\n|    C22 C26|    3|\n+-----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1560874924579_53900225","id":"20190617-141537_1379619862","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25896"},{"text":"def getCabinsCount(input: String): Int = {\n    Option(input) match {\n        case Some(x) => x.split(\" \").length\n        case None => -1\n    }\n}","user":"anonymous","dateUpdated":"2019-06-18T20:31:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"getCabinsCount: (input: String)Int\n"}]},"apps":[],"jobName":"paragraph_1560874924580_262450090","id":"20190617-142258_1205068028","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25897"},{"text":"val numPattern = \"([a-z])([0-9]+)\".r\n\ndef getNumbersFromCabin(input: String): Int = {\n    Option(input) match {\n        case Some(x) => {\n            x.split(\" \")(0).toLowerCase match {\n                case numPattern(sym, num) => Integer.parseInt(num)\n                case _ => -1\n            }\n        }\n        case None => -2\n    }\n}","user":"anonymous","dateUpdated":"2019-06-18T20:31:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"numPattern: scala.util.matching.Regex = ([a-z])([0-9]+)\ngetNumbersFromCabin: (input: String)Int\n"}]},"apps":[],"jobName":"paragraph_1560874924585_2049475546","id":"20190617-165356_767002277","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25898"},{"text":"val cabinsCountUDF = udf(getCabinsCount _)\nval numbersFromCabinUDF = udf(getNumbersFromCabin _)\n\nval cabinsCountTransformer = new UDFTransformer()\n    .setInputCol(\"Cabin\")\n    .setOutputCol(\"CabinCount\")\n    .setUDF(cabinsCountUDF)\n    \nval numbersFromCabinTransformer = new UDFTransformer()\n    .setInputCol(\"Cabin\")\n    .setOutputCol(\"CabinNumber\")\n    .setUDF(numbersFromCabinUDF)","user":"anonymous","dateUpdated":"2019-06-18T20:27:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cabinsCountUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,Some(List(StringType)))\nnumbersFromCabinUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,Some(List(StringType)))\ncabinsCountTransformer: com.microsoft.ml.spark.UDFTransformer = UDFTransformer_edc98022bc89\nnumbersFromCabinTransformer: com.microsoft.ml.spark.UDFTransformer = UDFTransformer_d7bf751cf271\n"}]},"apps":[],"jobName":"paragraph_1560874924586_1101504874","id":"20190617-180514_581183464","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25899"},{"text":"trainFiltered.select(col(\"Age\"))\n    .createOrReplaceTempView(\"age\")","user":"anonymous","dateUpdated":"2019-06-18T20:27:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560874924587_-2093267368","id":"20190617-142015_1464479878","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25900"},{"text":"%sql\nselect * from age","user":"anonymous","dateUpdated":"2019-06-18T18:30:32+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[{"name":"Age","index":0,"aggr":"sum"}],"values":[{"name":"Age","index":0,"aggr":"count"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Age\n22\n38\n26\n35\n35\nnull\n54\n2\n27\n14\n4\n58\n20\n39\n14\n55\n2\nnull\n31\nnull\n35\n34\n15\n28\n8\n38\nnull\n19\nnull\nnull\n40\nnull\nnull\n66\n28\n42\nnull\n21\n18\n14\n40\n27\nnull\n3\n19\nnull\nnull\nnull\nnull\n18\n7\n21\n49\n29\n65\nnull\n21\n5\n11\n22\n38\n45\n4\nnull\nnull\n29\n19\n17\n26\n32\n16\n21\n26\n32\n25\nnull\nnull\n30\n22\n29\nnull\n28\n17\n33\n16\nnull\n23\n24\n29\n20\n46\n26\n59\nnull\n71\n23\n34\n34\n28\nnull\n21\n33\n37\n28\n21\nnull\n38\nnull\n47\n22\n20\n17\n21\n29\n24\n2\n21\nnull\n54\n12\nnull\n24\nnull\n45\n33\n20\n47\n29\n25\n23\n19\n37\n16\n24\nnull\n22\n24\n19\n18\n19\n27\n9\n42\n51\n22\nnull\n51\n16\n30\nnull\nnull\n44\n40\n26\n17\n1\n9\nnull\n45\nnull\n28\n61\n4\n1\n21\n56\n18\nnull\n50\n30\n36\nnull\nnull\n9\n1\n4\nnull\nnull\n45\n40\n36\n32\n19\n19\n3\n44\n58\nnull\n42\nnull\n24\n28\nnull\n34\n18\n2\n32\n26\n16\n40\n24\n35\n22\n30\nnull\n31\n27\n42\n32\n30\n16\n27\n51\nnull\n38\n22\n19\n18\nnull\n35\n29\n59\n5\n24\nnull\n44\n8\n19\n33\nnull\nnull\n29\n22\n30\n44\n25\n24\n37\n54\nnull\n29\n62\n30\n41\n29\nnull\n30\n35\n50\nnull\n3\n52\n40\nnull\n36\n16\n25\n58\n35\nnull\n25\n41\n37\nnull\n63\n45\nnull\n7\n35\n65\n28\n16\n19\nnull\n33\n30\n22\n42\n22\n26\n19\n36\n24\n24\nnull\n2\nnull\n50\nnull\nnull\n19\nnull\nnull\nnull\n17\n30\n30\n24\n18\n26\n28\n43\n26\n24\n54\n31\n40\n22\n27\n30\n22\nnull\n36\n61\n36\n31\n16\nnull\n38\n16\nnull\nnull\n29\n41\n45\n45\n2\n24\n28\n25\n36\n24\n40\nnull\n3\n42\n23\nnull\n15\n25\nnull\n28\n22\n38\nnull\nnull\n40\n29\n45\n35\nnull\n30\n60\nnull\nnull\n24\n25\n18\n19\n22\n3\nnull\n22\n27\n20\n19\n42\n1\n32\n35\nnull\n18\n1\n36\nnull\n17\n36\n21\n28\n23\n24\n22\n31\n46\n23\n28\n39\n26\n21\n28\n20\n34\n51\n3\n21\nnull\nnull\nnull\n33\nnull\n44\nnull\n34\n18\n30\n10\nnull\n21\n29\n28\n18\nnull\n28\n19\nnull\n32\n28\nnull\n42\n17\n50\n14\n21\n24\n64\n31\n45\n20\n25\n28\nnull\n4\n13\n34\n5\n52\n36\nnull\n30\n49\nnull\n29\n65\nnull\n50\nnull\n48\n34\n47\n48\nnull\n38\nnull\n56\nnull\nnull\n38\n33\n23\n22\nnull\n34\n29\n22\n2\n9\nnull\n50\n63\n25\nnull\n35\n58\n30\n9\nnull\n21\n55\n71\n21\nnull\n54\nnull\n25\n24\n17\n21\nnull\n37\n16\n18\n33\nnull\n28\n26\n29\nnull\n36\n54\n24\n47\n34\nnull\n36\n32\n30\n22\nnull\n44\nnull\n50\nnull\n39\n23\n2\nnull\n17\nnull\n30\n7\n45\n30\nnull\n22\n36\n9\n11\n32\n50\n64\n19\nnull\n33\n8\n17\n27\nnull\n22\n22\n62\n48\nnull\n39\n36\nnull\n40\n28\nnull\nnull\n24\n19\n29\nnull\n32\n62\n53\n36\nnull\n16\n19\n34\n39\nnull\n32\n25\n39\n54\n36\nnull\n18\n47\n60\n22\nnull\n35\n52\n47\nnull\n37\n36\nnull\n49\nnull\n49\n24\nnull\nnull\n44\n35\n36\n30\n27\n22\n40\n39\nnull\nnull\nnull\n35\n24\n34\n26\n4\n26\n27\n42\n20\n21\n21\n61\n57\n21\n26\nnull\n80\n51\n32\nnull\n9\n28\n32\n31\n41\nnull\n20\n24\n2\nnull\n48\n19\n56\nnull\n23\nnull\n18\n21\nnull\n18\n24\nnull\n32\n23\n58\n50\n40\n47\n36\n20\n32\n25\nnull\n43\nnull\n40\n31\n70\n31\nnull\n18\n18\n43\n36\nnull\n27\n20\n14\n60\n25\n14\n19\n18\n15\n31\n4\nnull\n25\n60\n52\n44\nnull\n49\n42\n18\n35\n18\n25\n26\n39\n45\n42\n22\nnull\n24\nnull\n48\n29\n52\n19\n38\n27\nnull\n33\n6\n17\n34\n50\n27\n20\n30\nnull\n25\n25\n29\n11\nnull\n23\n23\n48\n35\nnull\nnull\nnull\n36\n21\n24\n31\n70\n16\n30\n19\n31\n4\n6\n33\n23\n48\n28\n18\n34\n33\nnull\n41\n20\n36\n16\n51\nnull\nnull\n32\n24\n48\n57\nnull\n54\n18\nnull\n5\nnull\n43\n13\n17\n29\nnull\n25\n25\n18\n8\n1\n46\nnull\n16\nnull\nnull\n25\n39\n49\n31\n30\n30\n34\n31\n11\n27\n31\n39\n18\n39\n33\n26\n39\n35\n6\nnull\n23\n31\n43\n10\n52\n27\n38\n27\n2\nnull\nnull\n1\nnull\n62\n15\nnull\n23\n18\n39\n21\nnull\n32\nnull\n20\n16\n30\n17\n42\nnull\n35\n28\nnull\n4\n74\n9\n16\n44\n18\n45\n51\n24\nnull\n41\n21\n48\nnull\n24\n42\n27\n31\nnull\n4\n26\n47\n33\n47\n28\n15\n20\n19\nnull\n56\n25\n33\n22\n28\n25\n39\n27\n19\nnull\n26\n32\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1560874924588_914840071","id":"20190617-181219_819630619","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25901"},{"text":"import org.apache.spark.sql.{Dataset, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.ml.{Estimator, Model}\n\nimport org.apache.spark.ml.param.{Param, ParamMap}\nimport com.microsoft.ml.spark.{HasInputCol, HasOutputCol, ConstructorWritable, ConstructorReadable, Wrappable}\n\nimport org.apache.spark.ml.util.Identifiable\nimport org.apache.spark.ml.util.DefaultParamsWritable\n\nimport reflect.runtime.universe.{TypeTag, typeTag}\n\nclass GroupImputerEstimator(override val uid: String) extends Estimator[GroupImputerModel]\nwith HasInputCol with HasOutputCol with Wrappable with DefaultParamsWritable\n{\n    def this() = this(Identifiable.randomUID(\"GroupImputer\"))\n    \n    val groupCol: Param[String] = new Param[String](this, \"groupCol\", \"Groupping column\")\n    def setGroupCol(v: String): this.type = super.set(groupCol, v)\n    def getGroupCol: String = $(groupCol)\n    \n    override def fit(dataset: Dataset[_]): GroupImputerModel = {\n        val meanDF = dataset\n            .toDF\n            .groupBy($(groupCol))\n            .agg(mean(col($(inputCol))).alias(\"groupMean\"))\n            .select(col($(groupCol)), col(\"groupMean\"))\n            \n        new GroupImputerModel(uid, meanDF, getInputCol, getOutputCol, getGroupCol)\n    }\n    \n    override def transformSchema(schema: StructType): StructType = schema\n        .add(\n            StructField($(outputCol), schema.filter(x => x.name == $(inputCol))(0).dataType)\n        )\n    \n    override def copy(extra: ParamMap): Estimator[GroupImputerModel] = {\n        val to = new GroupImputerEstimator(this.uid)\n        copyValues(to, extra).asInstanceOf[GroupImputerEstimator]\n    }\n}\n\n\nclass GroupImputerModel(\n    val uid: String,\n    val meanDF: DataFrame,\n    val inputCol: String,\n    val outputCol: String,\n    val groupCol: String\n)\nextends Model[GroupImputerModel]\nwith ConstructorWritable[GroupImputerModel]\n{\n    val ttag: TypeTag[GroupImputerModel] = typeTag[GroupImputerModel]\n    def objectsToSave: List[Any] = List(uid, meanDF, inputCol, outputCol, groupCol)\n    \n    override def copy(extra: ParamMap): GroupImputerModel = \n        new GroupImputerModel(uid, meanDF, inputCol, outputCol, groupCol)\n        \n    override def transform(dataset: Dataset[_]): DataFrame = {\n        dataset\n            .toDF\n            .join(meanDF, Seq(groupCol), \"left\")\n            .withColumn(outputCol, coalesce(col(inputCol), col(\"groupMean\")).cast(IntegerType))\n            .drop(\"groupMean\")\n    }\n    \n    override def transformSchema (schema: StructType): StructType = schema\n        .add(\n            StructField(outputCol, schema.filter(x => x.name == inputCol)(0).dataType)\n        )\n}\n\nobject GroupImputerModel extends ConstructorReadable[GroupImputerModel]","user":"anonymous","dateUpdated":"2019-06-18T20:27:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{Dataset, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.ml.{Estimator, Model}\nimport org.apache.spark.ml.param.{Param, ParamMap}\nimport com.microsoft.ml.spark.{HasInputCol, HasOutputCol, ConstructorWritable, ConstructorReadable, Wrappable}\nimport org.apache.spark.ml.util.Identifiable\nimport org.apache.spark.ml.util.DefaultParamsWritable\nimport reflect.runtime.universe.{TypeTag, typeTag}\ndefined class GroupImputerEstimator\ndefined class GroupImputerModel\ndefined object GroupImputerModel\n"}]},"apps":[],"jobName":"paragraph_1560874924589_-880363130","id":"20190618-071953_1291854998","dateCreated":"2019-06-18T16:22:04+0000","dateStarted":"2019-06-18T18:40:30+0000","dateFinished":"2019-06-18T18:40:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25902"},{"text":"new GroupImputerEstimator()\n    .setInputCol(\"Age\")\n    .setOutputCol(\"AgeNoMissings\")\n    .setGroupCol(\"Sex\")\n    .fit(trainFiltered)\n    .transform(trainFiltered)\n    .createOrReplaceTempView(\"age\")","user":"anonymous","dateUpdated":"2019-06-18T20:31:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560874924590_-202066424","id":"20190617-181228_471363570","dateCreated":"2019-06-18T16:22:04+0000","dateStarted":"2019-06-18T17:02:06+0000","dateFinished":"2019-06-18T17:02:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25903"},{"text":"%sql\nselect AgeNoMissings from age","user":"anonymous","dateUpdated":"2019-06-18T18:30:32+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"AgeNoMissings":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate"}},"commonSetting":{},"keys":[],"groups":[{"name":"AgeNoMissings","index":0,"aggr":"sum"}],"values":[{"name":"AgeNoMissings","index":0,"aggr":"count"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"AgeNoMissings\n22\n38\n26\n35\n35\n30\n54\n2\n27\n14\n4\n58\n20\n39\n14\n55\n2\n30\n31\n28\n35\n34\n15\n28\n8\n38\n30\n19\n28\n30\n40\n28\n28\n66\n28\n42\n30\n21\n18\n14\n40\n27\n30\n3\n19\n30\n30\n28\n30\n18\n7\n21\n49\n29\n65\n30\n21\n5\n11\n22\n38\n45\n4\n30\n30\n29\n19\n17\n26\n32\n16\n21\n26\n32\n25\n30\n30\n30\n22\n29\n28\n28\n17\n33\n16\n30\n23\n24\n29\n20\n46\n26\n59\n30\n71\n23\n34\n34\n28\n30\n21\n33\n37\n28\n21\n30\n38\n28\n47\n22\n20\n17\n21\n29\n24\n2\n21\n30\n54\n12\n30\n24\n28\n45\n33\n20\n47\n29\n25\n23\n19\n37\n16\n24\n28\n22\n24\n19\n18\n19\n27\n9\n42\n51\n22\n30\n51\n16\n30\n30\n30\n44\n40\n26\n17\n1\n9\n28\n45\n30\n28\n61\n4\n1\n21\n56\n18\n30\n50\n30\n36\n28\n30\n9\n1\n4\n30\n28\n45\n40\n36\n32\n19\n19\n3\n44\n58\n30\n42\n28\n24\n28\n30\n34\n18\n2\n32\n26\n16\n40\n24\n35\n22\n30\n30\n31\n27\n42\n32\n30\n16\n27\n51\n30\n38\n22\n19\n18\n28\n35\n29\n59\n5\n24\n28\n44\n8\n19\n33\n28\n28\n29\n22\n30\n44\n25\n24\n37\n54\n30\n29\n62\n30\n41\n29\n28\n30\n35\n50\n30\n3\n52\n40\n28\n36\n16\n25\n58\n35\n30\n25\n41\n37\n28\n63\n45\n30\n7\n35\n65\n28\n16\n19\n30\n33\n30\n22\n42\n22\n26\n19\n36\n24\n24\n30\n2\n30\n50\n28\n30\n19\n28\n30\n28\n17\n30\n30\n24\n18\n26\n28\n43\n26\n24\n54\n31\n40\n22\n27\n30\n22\n30\n36\n61\n36\n31\n16\n28\n38\n16\n28\n30\n29\n41\n45\n45\n2\n24\n28\n25\n36\n24\n40\n28\n3\n42\n23\n30\n15\n25\n30\n28\n22\n38\n28\n28\n40\n29\n45\n35\n30\n30\n60\n28\n28\n24\n25\n18\n19\n22\n3\n28\n22\n27\n20\n19\n42\n1\n32\n35\n30\n18\n1\n36\n30\n17\n36\n21\n28\n23\n24\n22\n31\n46\n23\n28\n39\n26\n21\n28\n20\n34\n51\n3\n21\n28\n30\n30\n33\n30\n44\n28\n34\n18\n30\n10\n30\n21\n29\n28\n18\n30\n28\n19\n30\n32\n28\n28\n42\n17\n50\n14\n21\n24\n64\n31\n45\n20\n25\n28\n30\n4\n13\n34\n5\n52\n36\n30\n30\n49\n30\n29\n65\n28\n50\n30\n48\n34\n47\n48\n30\n38\n30\n56\n30\n30\n38\n33\n23\n22\n30\n34\n29\n22\n2\n9\n30\n50\n63\n25\n28\n35\n58\n30\n9\n30\n21\n55\n71\n21\n30\n54\n30\n25\n24\n17\n21\n28\n37\n16\n18\n33\n30\n28\n26\n29\n30\n36\n54\n24\n47\n34\n30\n36\n32\n30\n22\n30\n44\n30\n50\n30\n39\n23\n2\n30\n17\n28\n30\n7\n45\n30\n30\n22\n36\n9\n11\n32\n50\n64\n19\n30\n33\n8\n17\n27\n30\n22\n22\n62\n48\n30\n39\n36\n30\n40\n28\n30\n28\n24\n19\n29\n30\n32\n62\n53\n36\n28\n16\n19\n34\n39\n28\n32\n25\n39\n54\n36\n30\n18\n47\n60\n22\n30\n35\n52\n47\n28\n37\n36\n28\n49\n30\n49\n24\n30\n30\n44\n35\n36\n30\n27\n22\n40\n39\n30\n28\n30\n35\n24\n34\n26\n4\n26\n27\n42\n20\n21\n21\n61\n57\n21\n26\n30\n80\n51\n32\n30\n9\n28\n32\n31\n41\n30\n20\n24\n2\n30\n48\n19\n56\n30\n23\n30\n18\n21\n28\n18\n24\n30\n32\n23\n58\n50\n40\n47\n36\n20\n32\n25\n30\n43\n28\n40\n31\n70\n31\n30\n18\n18\n43\n36\n28\n27\n20\n14\n60\n25\n14\n19\n18\n15\n31\n4\n30\n25\n60\n52\n44\n28\n49\n42\n18\n35\n18\n25\n26\n39\n45\n42\n22\n30\n24\n30\n48\n29\n52\n19\n38\n27\n30\n33\n6\n17\n34\n50\n27\n20\n30\n28\n25\n25\n29\n11\n30\n23\n23\n48\n35\n30\n30\n30\n36\n21\n24\n31\n70\n16\n30\n19\n31\n4\n6\n33\n23\n48\n28\n18\n34\n33\n30\n41\n20\n36\n16\n51\n30\n30\n32\n24\n48\n57\n30\n54\n18\n30\n5\n30\n43\n13\n17\n29\n30\n25\n25\n18\n8\n1\n46\n30\n16\n28\n30\n25\n39\n49\n31\n30\n30\n34\n31\n11\n27\n31\n39\n18\n39\n33\n26\n39\n35\n6\n30\n23\n31\n43\n10\n52\n27\n38\n27\n2\n30\n30\n1\n30\n62\n15\n30\n23\n18\n39\n21\n30\n32\n30\n20\n16\n30\n17\n42\n30\n35\n28\n28\n4\n74\n9\n16\n44\n18\n45\n51\n24\n30\n41\n21\n48\n28\n24\n42\n27\n31\n30\n4\n26\n47\n33\n47\n28\n15\n20\n19\n30\n56\n25\n33\n22\n28\n25\n39\n27\n19\n28\n26\n32\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1560874924590_-1639458814","id":"20190618-154932_2048917716","dateCreated":"2019-06-18T16:22:04+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25904"},{"text":"import org.apache.spark.ml.feature.{StringIndexer, VectorAssembler}\nimport org.apache.spark.ml.Pipeline\n\nimport com.microsoft.ml.spark.{MultiColumnAdapter, ClassBalancer, LightGBMClassifier}","user":"anonymous","dateUpdated":"2019-06-18T20:30:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.{StringIndexer, VectorAssembler}\nimport org.apache.spark.ml.Pipeline\nimport com.microsoft.ml.spark.{MultiColumnAdapter, ClassBalancer, LightGBMClassifier}\n"}]},"apps":[],"jobName":"paragraph_1560874924591_1172088155","id":"20190618-063046_766964640","dateCreated":"2019-06-18T16:22:04+0000","dateStarted":"2019-06-18T16:34:51+0000","dateFinished":"2019-06-18T16:34:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25905"},{"text":"val catCols = Array(\"Sex\", \"Embarked\", \"NameType\")\nval numCols = Array(\"PClass\", \"AgeNoMissings\", \"SibSp\", \"Parch\", \"CabinCount\", \"CabinNumber\")\n\nval stringEncoder = new MultiColumnAdapter()\n    .setBaseStage(new StringIndexer().setHandleInvalid(\"keep\"))\n    .setInputCols(catCols)\n    .setOutputCols(catCols.map(x => x + \"_freqEncoded\"))\n    \nval missingImputer = new GroupImputerEstimator()\n    .setInputCol(\"Age\")\n    .setOutputCol(\"AgeNoMissings\")\n    .setGroupCol(\"Sex\")\n    \nval assembler = new VectorAssembler()\n    .setInputCols(stringEncoder.getOutputCols ++ numCols)\n    .setOutputCol(\"features\")\n    \nval catColIndices = Array(0, 1, 2)\n\nval lgbClf = new LightGBMClassifier()\n    .setFeaturesCol(\"features\")\n    .setLabelCol(\"Survived\")\n    .setProbabilityCol(\"predictedProb\")\n    .setPredictionCol(\"predictedLabel\")\n    .setRawPredictionCol(\"rawPrediction\")\n    .setIsUnbalance(true)\n    .setCategoricalSlotIndexes(catColIndices)\n    .setObjective(\"binary\")\n\nval pipeline = new Pipeline()\n    .setStages(\n        Array(\n            missingImputer,\n            nameTransformer,\n            cabinsCountTransformer,\n            numbersFromCabinTransformer,\n            stringEncoder,\n            assembler,\n            lgbClf\n        )\n    )","user":"anonymous","dateUpdated":"2019-06-18T19:59:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"catCols: Array[String] = Array(Sex, Embarked, NameType)\nnumCols: Array[String] = Array(PClass, AgeNoMissings, SibSp, Parch, CabinCount, CabinNumber)\nstringEncoder: com.microsoft.ml.spark.MultiColumnAdapter = MultiColumnAdapter_c80cef340c4d\nmissingImputer: GroupImputerEstimator = GroupImputer_737eaf09181a\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_90a6e00ba9d6\ncatColIndices: Array[Int] = Array(0, 1, 2)\nlgbClf: com.microsoft.ml.spark.LightGBMClassifier = LightGBMClassifier_5e76ee99cd50\npipeline: org.apache.spark.ml.Pipeline = pipeline_59e24e192a2d\n"}]},"apps":[],"jobName":"paragraph_1560874924592_496117246","id":"20190618-061402_279370488","dateCreated":"2019-06-18T16:22:04+0000","dateStarted":"2019-06-18T18:57:20+0000","dateFinished":"2019-06-18T18:57:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25906"},{"text":"import org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator","user":"anonymous","dateUpdated":"2019-06-18T18:40:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n"}]},"apps":[],"jobName":"paragraph_1560875706646_-901353616","id":"20190618-163506_193805866","dateCreated":"2019-06-18T16:35:06+0000","dateStarted":"2019-06-18T18:40:55+0000","dateFinished":"2019-06-18T18:40:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25907"},{"text":"val paramSpace = new ParamGridBuilder()\n    .addGrid(lgbClf.maxDepth, Array(3, 5))\n    .addGrid(lgbClf.learningRate, Array(0.05, 0.1))\n    .addGrid(lgbClf.numIterations, Array(100, 300))\n    .build\n    \nprintln(s\"Size of ParamsGrid: ${paramSpace.size}\")\n    \nval crossValidator = new CrossValidator()\n    .setEstimator(pipeline)\n    .setEstimatorParamMaps(paramSpace)\n    .setNumFolds(3)\n    .setSeed(42L)\n    .setEvaluator(\n        new BinaryClassificationEvaluator()\n            .setMetricName(\"areaUnderROC\")\n            .setLabelCol(\"Survived\")\n            .setRawPredictionCol(\"rawPrediction\")\n    )","user":"anonymous","dateUpdated":"2019-06-18T19:00:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Size of ParamsGrid: 8\nparamSpace: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tLightGBMClassifier_5e76ee99cd50-learningRate: 0.05,\n\tLightGBMClassifier_5e76ee99cd50-maxDepth: 3,\n\tLightGBMClassifier_5e76ee99cd50-numIterations: 100\n}, {\n\tLightGBMClassifier_5e76ee99cd50-learningRate: 0.1,\n\tLightGBMClassifier_5e76ee99cd50-maxDepth: 3,\n\tLightGBMClassifier_5e76ee99cd50-numIterations: 100\n}, {\n\tLightGBMClassifier_5e76ee99cd50-learningRate: 0.05,\n\tLightGBMClassifier_5e76ee99cd50-maxDepth: 5,\n\tLightGBMClassifier_5e76ee99cd50-numIterations: 100\n}, {\n\tLightGBMClassifier_5e76ee99cd50-learningRate: 0.1,\n\tLightGBMClassifier_5e76ee99cd50-maxDepth: 5,\n\tLightGBMClassifier_5e76ee99cd50-numIterations: 100\n}, {\n\tLightGBMClassifier_5e76ee99cd50-learningRate: 0.05,\n\tLightGBMClassifier_5e76ee99cd50-maxDepth: 3,\n\tLightGBMCla..."}]},"apps":[],"jobName":"paragraph_1560875837102_2017361849","id":"20190618-163717_1855838586","dateCreated":"2019-06-18T16:37:17+0000","dateStarted":"2019-06-18T19:00:48+0000","dateFinished":"2019-06-18T19:00:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25908"},{"text":"val bestModel = crossValidator\n    .fit(trainFiltered)","user":"anonymous","dateUpdated":"2019-06-18T19:00:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"data":"","type":"TEXT"}]},"apps":[],"jobName":"paragraph_1560876032612_-149356545","id":"20190618-164032_1456350550","dateCreated":"2019-06-18T16:40:32+0000","dateStarted":"2019-06-18T19:01:02+0000","dateFinished":"2019-06-18T19:11:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25910","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1045","http://172.17.0.2:4040/jobs/job?id=1046","http://172.17.0.2:4040/jobs/job?id=1047","http://172.17.0.2:4040/jobs/job?id=1048","http://172.17.0.2:4040/jobs/job?id=1049","http://172.17.0.2:4040/jobs/job?id=1050","http://172.17.0.2:4040/jobs/job?id=1051","http://172.17.0.2:4040/jobs/job?id=1052","http://172.17.0.2:4040/jobs/job?id=1053","http://172.17.0.2:4040/jobs/job?id=1054","http://172.17.0.2:4040/jobs/job?id=1055","http://172.17.0.2:4040/jobs/job?id=1056","http://172.17.0.2:4040/jobs/job?id=1057","http://172.17.0.2:4040/jobs/job?id=1058","http://172.17.0.2:4040/jobs/job?id=1059","http://172.17.0.2:4040/jobs/job?id=1060","http://172.17.0.2:4040/jobs/job?id=1061","http://172.17.0.2:4040/jobs/job?id=1062","http://172.17.0.2:4040/jobs/job?id=1063","http://172.17.0.2:4040/jobs/job?id=1064","http://172.17.0.2:4040/jobs/job?id=1065","http://172.17.0.2:4040/jobs/job?id=1066","http://172.17.0.2:4040/jobs/job?id=1067","http://172.17.0.2:4040/jobs/job?id=1068","http://172.17.0.2:4040/jobs/job?id=1069","http://172.17.0.2:4040/jobs/job?id=1070","http://172.17.0.2:4040/jobs/job?id=1071","http://172.17.0.2:4040/jobs/job?id=1072","http://172.17.0.2:4040/jobs/job?id=1073","http://172.17.0.2:4040/jobs/job?id=1074","http://172.17.0.2:4040/jobs/job?id=1075","http://172.17.0.2:4040/jobs/job?id=1076","http://172.17.0.2:4040/jobs/job?id=1077","http://172.17.0.2:4040/jobs/job?id=1078","http://172.17.0.2:4040/jobs/job?id=1079","http://172.17.0.2:4040/jobs/job?id=1080","http://172.17.0.2:4040/jobs/job?id=1081","http://172.17.0.2:4040/jobs/job?id=1082","http://172.17.0.2:4040/jobs/job?id=1083","http://172.17.0.2:4040/jobs/job?id=1084","http://172.17.0.2:4040/jobs/job?id=1085","http://172.17.0.2:4040/jobs/job?id=1086","http://172.17.0.2:4040/jobs/job?id=1087","http://172.17.0.2:4040/jobs/job?id=1088","http://172.17.0.2:4040/jobs/job?id=1089","http://172.17.0.2:4040/jobs/job?id=1090","http://172.17.0.2:4040/jobs/job?id=1091","http://172.17.0.2:4040/jobs/job?id=1092","http://172.17.0.2:4040/jobs/job?id=1093","http://172.17.0.2:4040/jobs/job?id=1094","http://172.17.0.2:4040/jobs/job?id=1095","http://172.17.0.2:4040/jobs/job?id=1096","http://172.17.0.2:4040/jobs/job?id=1097","http://172.17.0.2:4040/jobs/job?id=1098","http://172.17.0.2:4040/jobs/job?id=1099","http://172.17.0.2:4040/jobs/job?id=1100","http://172.17.0.2:4040/jobs/job?id=1101","http://172.17.0.2:4040/jobs/job?id=1102","http://172.17.0.2:4040/jobs/job?id=1103","http://172.17.0.2:4040/jobs/job?id=1104","http://172.17.0.2:4040/jobs/job?id=1105","http://172.17.0.2:4040/jobs/job?id=1106","http://172.17.0.2:4040/jobs/job?id=1107","http://172.17.0.2:4040/jobs/job?id=1108","http://172.17.0.2:4040/jobs/job?id=1109","http://172.17.0.2:4040/jobs/job?id=1110","http://172.17.0.2:4040/jobs/job?id=1111","http://172.17.0.2:4040/jobs/job?id=1112","http://172.17.0.2:4040/jobs/job?id=1113","http://172.17.0.2:4040/jobs/job?id=1114","http://172.17.0.2:4040/jobs/job?id=1115","http://172.17.0.2:4040/jobs/job?id=1116","http://172.17.0.2:4040/jobs/job?id=1117","http://172.17.0.2:4040/jobs/job?id=1118","http://172.17.0.2:4040/jobs/job?id=1119","http://172.17.0.2:4040/jobs/job?id=1120","http://172.17.0.2:4040/jobs/job?id=1121","http://172.17.0.2:4040/jobs/job?id=1122","http://172.17.0.2:4040/jobs/job?id=1123","http://172.17.0.2:4040/jobs/job?id=1124","http://172.17.0.2:4040/jobs/job?id=1125","http://172.17.0.2:4040/jobs/job?id=1126","http://172.17.0.2:4040/jobs/job?id=1127","http://172.17.0.2:4040/jobs/job?id=1128","http://172.17.0.2:4040/jobs/job?id=1129","http://172.17.0.2:4040/jobs/job?id=1130","http://172.17.0.2:4040/jobs/job?id=1131","http://172.17.0.2:4040/jobs/job?id=1132","http://172.17.0.2:4040/jobs/job?id=1133","http://172.17.0.2:4040/jobs/job?id=1134","http://172.17.0.2:4040/jobs/job?id=1135","http://172.17.0.2:4040/jobs/job?id=1136","http://172.17.0.2:4040/jobs/job?id=1137","http://172.17.0.2:4040/jobs/job?id=1138","http://172.17.0.2:4040/jobs/job?id=1139","http://172.17.0.2:4040/jobs/job?id=1140","http://172.17.0.2:4040/jobs/job?id=1141","http://172.17.0.2:4040/jobs/job?id=1142","http://172.17.0.2:4040/jobs/job?id=1143","http://172.17.0.2:4040/jobs/job?id=1144","http://172.17.0.2:4040/jobs/job?id=1145","http://172.17.0.2:4040/jobs/job?id=1146","http://172.17.0.2:4040/jobs/job?id=1147","http://172.17.0.2:4040/jobs/job?id=1148","http://172.17.0.2:4040/jobs/job?id=1149","http://172.17.0.2:4040/jobs/job?id=1150","http://172.17.0.2:4040/jobs/job?id=1151","http://172.17.0.2:4040/jobs/job?id=1152","http://172.17.0.2:4040/jobs/job?id=1153","http://172.17.0.2:4040/jobs/job?id=1154","http://172.17.0.2:4040/jobs/job?id=1155","http://172.17.0.2:4040/jobs/job?id=1156","http://172.17.0.2:4040/jobs/job?id=1157","http://172.17.0.2:4040/jobs/job?id=1158","http://172.17.0.2:4040/jobs/job?id=1159","http://172.17.0.2:4040/jobs/job?id=1160","http://172.17.0.2:4040/jobs/job?id=1161","http://172.17.0.2:4040/jobs/job?id=1162","http://172.17.0.2:4040/jobs/job?id=1163","http://172.17.0.2:4040/jobs/job?id=1164","http://172.17.0.2:4040/jobs/job?id=1165","http://172.17.0.2:4040/jobs/job?id=1166","http://172.17.0.2:4040/jobs/job?id=1167","http://172.17.0.2:4040/jobs/job?id=1168","http://172.17.0.2:4040/jobs/job?id=1169","http://172.17.0.2:4040/jobs/job?id=1170","http://172.17.0.2:4040/jobs/job?id=1171","http://172.17.0.2:4040/jobs/job?id=1172","http://172.17.0.2:4040/jobs/job?id=1173","http://172.17.0.2:4040/jobs/job?id=1174","http://172.17.0.2:4040/jobs/job?id=1175","http://172.17.0.2:4040/jobs/job?id=1176","http://172.17.0.2:4040/jobs/job?id=1177","http://172.17.0.2:4040/jobs/job?id=1178","http://172.17.0.2:4040/jobs/job?id=1179","http://172.17.0.2:4040/jobs/job?id=1180","http://172.17.0.2:4040/jobs/job?id=1181","http://172.17.0.2:4040/jobs/job?id=1182","http://172.17.0.2:4040/jobs/job?id=1183","http://172.17.0.2:4040/jobs/job?id=1184","http://172.17.0.2:4040/jobs/job?id=1185","http://172.17.0.2:4040/jobs/job?id=1186","http://172.17.0.2:4040/jobs/job?id=1187","http://172.17.0.2:4040/jobs/job?id=1188","http://172.17.0.2:4040/jobs/job?id=1189","http://172.17.0.2:4040/jobs/job?id=1190","http://172.17.0.2:4040/jobs/job?id=1191","http://172.17.0.2:4040/jobs/job?id=1192","http://172.17.0.2:4040/jobs/job?id=1193","http://172.17.0.2:4040/jobs/job?id=1194","http://172.17.0.2:4040/jobs/job?id=1195","http://172.17.0.2:4040/jobs/job?id=1196","http://172.17.0.2:4040/jobs/job?id=1197","http://172.17.0.2:4040/jobs/job?id=1198","http://172.17.0.2:4040/jobs/job?id=1199","http://172.17.0.2:4040/jobs/job?id=1200","http://172.17.0.2:4040/jobs/job?id=1201","http://172.17.0.2:4040/jobs/job?id=1202","http://172.17.0.2:4040/jobs/job?id=1203","http://172.17.0.2:4040/jobs/job?id=1204","http://172.17.0.2:4040/jobs/job?id=1205","http://172.17.0.2:4040/jobs/job?id=1206","http://172.17.0.2:4040/jobs/job?id=1207","http://172.17.0.2:4040/jobs/job?id=1208","http://172.17.0.2:4040/jobs/job?id=1209","http://172.17.0.2:4040/jobs/job?id=1210","http://172.17.0.2:4040/jobs/job?id=1211","http://172.17.0.2:4040/jobs/job?id=1212","http://172.17.0.2:4040/jobs/job?id=1213","http://172.17.0.2:4040/jobs/job?id=1214","http://172.17.0.2:4040/jobs/job?id=1215","http://172.17.0.2:4040/jobs/job?id=1216","http://172.17.0.2:4040/jobs/job?id=1217","http://172.17.0.2:4040/jobs/job?id=1218","http://172.17.0.2:4040/jobs/job?id=1219","http://172.17.0.2:4040/jobs/job?id=1220","http://172.17.0.2:4040/jobs/job?id=1221","http://172.17.0.2:4040/jobs/job?id=1222","http://172.17.0.2:4040/jobs/job?id=1223","http://172.17.0.2:4040/jobs/job?id=1224","http://172.17.0.2:4040/jobs/job?id=1225","http://172.17.0.2:4040/jobs/job?id=1226","http://172.17.0.2:4040/jobs/job?id=1227","http://172.17.0.2:4040/jobs/job?id=1228","http://172.17.0.2:4040/jobs/job?id=1229","http://172.17.0.2:4040/jobs/job?id=1230","http://172.17.0.2:4040/jobs/job?id=1231","http://172.17.0.2:4040/jobs/job?id=1232","http://172.17.0.2:4040/jobs/job?id=1233","http://172.17.0.2:4040/jobs/job?id=1234","http://172.17.0.2:4040/jobs/job?id=1235","http://172.17.0.2:4040/jobs/job?id=1236","http://172.17.0.2:4040/jobs/job?id=1237","http://172.17.0.2:4040/jobs/job?id=1238","http://172.17.0.2:4040/jobs/job?id=1239","http://172.17.0.2:4040/jobs/job?id=1240","http://172.17.0.2:4040/jobs/job?id=1241","http://172.17.0.2:4040/jobs/job?id=1242","http://172.17.0.2:4040/jobs/job?id=1243","http://172.17.0.2:4040/jobs/job?id=1244","http://172.17.0.2:4040/jobs/job?id=1245","http://172.17.0.2:4040/jobs/job?id=1246","http://172.17.0.2:4040/jobs/job?id=1247","http://172.17.0.2:4040/jobs/job?id=1248","http://172.17.0.2:4040/jobs/job?id=1249","http://172.17.0.2:4040/jobs/job?id=1250","http://172.17.0.2:4040/jobs/job?id=1251","http://172.17.0.2:4040/jobs/job?id=1252","http://172.17.0.2:4040/jobs/job?id=1253","http://172.17.0.2:4040/jobs/job?id=1254","http://172.17.0.2:4040/jobs/job?id=1255","http://172.17.0.2:4040/jobs/job?id=1256","http://172.17.0.2:4040/jobs/job?id=1257","http://172.17.0.2:4040/jobs/job?id=1258","http://172.17.0.2:4040/jobs/job?id=1259","http://172.17.0.2:4040/jobs/job?id=1260","http://172.17.0.2:4040/jobs/job?id=1261","http://172.17.0.2:4040/jobs/job?id=1262","http://172.17.0.2:4040/jobs/job?id=1263","http://172.17.0.2:4040/jobs/job?id=1264","http://172.17.0.2:4040/jobs/job?id=1265","http://172.17.0.2:4040/jobs/job?id=1266","http://172.17.0.2:4040/jobs/job?id=1267","http://172.17.0.2:4040/jobs/job?id=1268","http://172.17.0.2:4040/jobs/job?id=1269","http://172.17.0.2:4040/jobs/job?id=1270","http://172.17.0.2:4040/jobs/job?id=1271","http://172.17.0.2:4040/jobs/job?id=1272","http://172.17.0.2:4040/jobs/job?id=1273","http://172.17.0.2:4040/jobs/job?id=1274","http://172.17.0.2:4040/jobs/job?id=1275","http://172.17.0.2:4040/jobs/job?id=1276","http://172.17.0.2:4040/jobs/job?id=1277","http://172.17.0.2:4040/jobs/job?id=1278","http://172.17.0.2:4040/jobs/job?id=1279","http://172.17.0.2:4040/jobs/job?id=1280","http://172.17.0.2:4040/jobs/job?id=1281","http://172.17.0.2:4040/jobs/job?id=1282","http://172.17.0.2:4040/jobs/job?id=1283","http://172.17.0.2:4040/jobs/job?id=1284","http://172.17.0.2:4040/jobs/job?id=1285","http://172.17.0.2:4040/jobs/job?id=1286","http://172.17.0.2:4040/jobs/job?id=1287","http://172.17.0.2:4040/jobs/job?id=1288","http://172.17.0.2:4040/jobs/job?id=1289","http://172.17.0.2:4040/jobs/job?id=1290","http://172.17.0.2:4040/jobs/job?id=1291","http://172.17.0.2:4040/jobs/job?id=1292","http://172.17.0.2:4040/jobs/job?id=1293","http://172.17.0.2:4040/jobs/job?id=1294","http://172.17.0.2:4040/jobs/job?id=1295","http://172.17.0.2:4040/jobs/job?id=1296","http://172.17.0.2:4040/jobs/job?id=1297","http://172.17.0.2:4040/jobs/job?id=1298","http://172.17.0.2:4040/jobs/job?id=1299","http://172.17.0.2:4040/jobs/job?id=1300","http://172.17.0.2:4040/jobs/job?id=1301","http://172.17.0.2:4040/jobs/job?id=1302","http://172.17.0.2:4040/jobs/job?id=1303","http://172.17.0.2:4040/jobs/job?id=1304","http://172.17.0.2:4040/jobs/job?id=1305","http://172.17.0.2:4040/jobs/job?id=1306","http://172.17.0.2:4040/jobs/job?id=1307","http://172.17.0.2:4040/jobs/job?id=1308","http://172.17.0.2:4040/jobs/job?id=1309","http://172.17.0.2:4040/jobs/job?id=1310","http://172.17.0.2:4040/jobs/job?id=1311","http://172.17.0.2:4040/jobs/job?id=1312","http://172.17.0.2:4040/jobs/job?id=1313","http://172.17.0.2:4040/jobs/job?id=1314","http://172.17.0.2:4040/jobs/job?id=1315","http://172.17.0.2:4040/jobs/job?id=1316","http://172.17.0.2:4040/jobs/job?id=1317","http://172.17.0.2:4040/jobs/job?id=1318","http://172.17.0.2:4040/jobs/job?id=1319","http://172.17.0.2:4040/jobs/job?id=1320","http://172.17.0.2:4040/jobs/job?id=1321","http://172.17.0.2:4040/jobs/job?id=1322","http://172.17.0.2:4040/jobs/job?id=1323","http://172.17.0.2:4040/jobs/job?id=1324","http://172.17.0.2:4040/jobs/job?id=1325","http://172.17.0.2:4040/jobs/job?id=1326","http://172.17.0.2:4040/jobs/job?id=1327","http://172.17.0.2:4040/jobs/job?id=1328","http://172.17.0.2:4040/jobs/job?id=1329","http://172.17.0.2:4040/jobs/job?id=1330","http://172.17.0.2:4040/jobs/job?id=1331","http://172.17.0.2:4040/jobs/job?id=1332","http://172.17.0.2:4040/jobs/job?id=1333","http://172.17.0.2:4040/jobs/job?id=1334","http://172.17.0.2:4040/jobs/job?id=1335","http://172.17.0.2:4040/jobs/job?id=1336","http://172.17.0.2:4040/jobs/job?id=1337","http://172.17.0.2:4040/jobs/job?id=1338","http://172.17.0.2:4040/jobs/job?id=1339","http://172.17.0.2:4040/jobs/job?id=1340","http://172.17.0.2:4040/jobs/job?id=1341","http://172.17.0.2:4040/jobs/job?id=1342","http://172.17.0.2:4040/jobs/job?id=1343","http://172.17.0.2:4040/jobs/job?id=1344","http://172.17.0.2:4040/jobs/job?id=1345","http://172.17.0.2:4040/jobs/job?id=1346","http://172.17.0.2:4040/jobs/job?id=1347","http://172.17.0.2:4040/jobs/job?id=1348","http://172.17.0.2:4040/jobs/job?id=1349","http://172.17.0.2:4040/jobs/job?id=1350","http://172.17.0.2:4040/jobs/job?id=1351","http://172.17.0.2:4040/jobs/job?id=1352","http://172.17.0.2:4040/jobs/job?id=1353","http://172.17.0.2:4040/jobs/job?id=1354","http://172.17.0.2:4040/jobs/job?id=1355","http://172.17.0.2:4040/jobs/job?id=1356","http://172.17.0.2:4040/jobs/job?id=1357","http://172.17.0.2:4040/jobs/job?id=1358","http://172.17.0.2:4040/jobs/job?id=1359","http://172.17.0.2:4040/jobs/job?id=1360","http://172.17.0.2:4040/jobs/job?id=1361","http://172.17.0.2:4040/jobs/job?id=1362","http://172.17.0.2:4040/jobs/job?id=1363","http://172.17.0.2:4040/jobs/job?id=1364","http://172.17.0.2:4040/jobs/job?id=1365","http://172.17.0.2:4040/jobs/job?id=1366","http://172.17.0.2:4040/jobs/job?id=1367","http://172.17.0.2:4040/jobs/job?id=1368","http://172.17.0.2:4040/jobs/job?id=1369","http://172.17.0.2:4040/jobs/job?id=1370","http://172.17.0.2:4040/jobs/job?id=1371","http://172.17.0.2:4040/jobs/job?id=1372","http://172.17.0.2:4040/jobs/job?id=1373","http://172.17.0.2:4040/jobs/job?id=1374","http://172.17.0.2:4040/jobs/job?id=1375","http://172.17.0.2:4040/jobs/job?id=1376","http://172.17.0.2:4040/jobs/job?id=1377","http://172.17.0.2:4040/jobs/job?id=1378","http://172.17.0.2:4040/jobs/job?id=1379","http://172.17.0.2:4040/jobs/job?id=1380","http://172.17.0.2:4040/jobs/job?id=1381","http://172.17.0.2:4040/jobs/job?id=1382","http://172.17.0.2:4040/jobs/job?id=1383","http://172.17.0.2:4040/jobs/job?id=1384","http://172.17.0.2:4040/jobs/job?id=1385","http://172.17.0.2:4040/jobs/job?id=1386","http://172.17.0.2:4040/jobs/job?id=1387","http://172.17.0.2:4040/jobs/job?id=1388","http://172.17.0.2:4040/jobs/job?id=1389","http://172.17.0.2:4040/jobs/job?id=1390","http://172.17.0.2:4040/jobs/job?id=1391","http://172.17.0.2:4040/jobs/job?id=1392","http://172.17.0.2:4040/jobs/job?id=1393","http://172.17.0.2:4040/jobs/job?id=1394","http://172.17.0.2:4040/jobs/job?id=1395","http://172.17.0.2:4040/jobs/job?id=1396","http://172.17.0.2:4040/jobs/job?id=1397","http://172.17.0.2:4040/jobs/job?id=1398","http://172.17.0.2:4040/jobs/job?id=1399","http://172.17.0.2:4040/jobs/job?id=1400","http://172.17.0.2:4040/jobs/job?id=1401","http://172.17.0.2:4040/jobs/job?id=1402","http://172.17.0.2:4040/jobs/job?id=1403","http://172.17.0.2:4040/jobs/job?id=1404","http://172.17.0.2:4040/jobs/job?id=1405","http://172.17.0.2:4040/jobs/job?id=1406","http://172.17.0.2:4040/jobs/job?id=1407","http://172.17.0.2:4040/jobs/job?id=1408","http://172.17.0.2:4040/jobs/job?id=1409","http://172.17.0.2:4040/jobs/job?id=1410","http://172.17.0.2:4040/jobs/job?id=1411","http://172.17.0.2:4040/jobs/job?id=1412","http://172.17.0.2:4040/jobs/job?id=1413","http://172.17.0.2:4040/jobs/job?id=1414","http://172.17.0.2:4040/jobs/job?id=1415","http://172.17.0.2:4040/jobs/job?id=1416","http://172.17.0.2:4040/jobs/job?id=1417","http://172.17.0.2:4040/jobs/job?id=1418","http://172.17.0.2:4040/jobs/job?id=1419","http://172.17.0.2:4040/jobs/job?id=1420","http://172.17.0.2:4040/jobs/job?id=1421","http://172.17.0.2:4040/jobs/job?id=1422","http://172.17.0.2:4040/jobs/job?id=1423","http://172.17.0.2:4040/jobs/job?id=1424","http://172.17.0.2:4040/jobs/job?id=1425","http://172.17.0.2:4040/jobs/job?id=1426","http://172.17.0.2:4040/jobs/job?id=1427","http://172.17.0.2:4040/jobs/job?id=1428","http://172.17.0.2:4040/jobs/job?id=1429","http://172.17.0.2:4040/jobs/job?id=1430","http://172.17.0.2:4040/jobs/job?id=1431","http://172.17.0.2:4040/jobs/job?id=1432","http://172.17.0.2:4040/jobs/job?id=1433","http://172.17.0.2:4040/jobs/job?id=1434","http://172.17.0.2:4040/jobs/job?id=1435","http://172.17.0.2:4040/jobs/job?id=1436","http://172.17.0.2:4040/jobs/job?id=1437"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560883645364_1027307603","id":"20190618-184725_1995528833","dateCreated":"2019-06-18T18:47:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32136","text":"crossValidator\n    .getEstimatorParamMaps\n    .zip(bestModel.avgMetrics)\n    .foreach(x => {\n        println(\n            \"\\n\" + x._1.toSeq.foldLeft(new StringBuilder())((a, b) => a.append(s\"\\n\\t${b.param.name} : ${b.value}\")).toString + s\"\\n\\tMetric: ${x._2}\"\n        )\n    })","dateUpdated":"2019-06-18T19:51:53+0000","dateFinished":"2019-06-18T19:51:55+0000","dateStarted":"2019-06-18T19:51:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\n\tlearningRate : 0.05\n\tmaxDepth : 3\n\tnumIterations : 100\n\tMetric: 0.859254255325067\n\n\n\tlearningRate : 0.1\n\tmaxDepth : 3\n\tnumIterations : 100\n\tMetric: 0.8592348391704664\n\n\n\tlearningRate : 0.05\n\tmaxDepth : 5\n\tnumIterations : 100\n\tMetric: 0.8596759394019516\n\n\n\tlearningRate : 0.1\n\tmaxDepth : 5\n\tnumIterations : 100\n\tMetric: 0.8554263413568953\n\n\n\tlearningRate : 0.05\n\tmaxDepth : 3\n\tnumIterations : 300\n\tMetric: 0.8546893419592362\n\n\n\tlearningRate : 0.1\n\tmaxDepth : 3\n\tnumIterations : 300\n\tMetric: 0.8530614472337908\n\n\n\tlearningRate : 0.05\n\tmaxDepth : 5\n\tnumIterations : 300\n\tMetric: 0.8504196087399993\n\n\n\tlearningRate : 0.1\n\tmaxDepth : 5\n\tnumIterations : 300\n\tMetric: 0.8477824007761632\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560887026019_161207984","id":"20190618-194346_1782267556","dateCreated":"2019-06-18T19:43:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34809","text":"import com.microsoft.ml.spark.ComputeModelStatistics\nimport com.microsoft.ml.spark.metrics.MetricConstants","dateUpdated":"2019-06-18T20:26:14+0000","dateFinished":"2019-06-18T20:26:15+0000","dateStarted":"2019-06-18T20:26:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.microsoft.ml.spark.ComputeModelStatistics\nimport com.microsoft.ml.spark.metrics.MetricConstants\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560887612099_-887737824","id":"20190618-195332_1076005126","dateCreated":"2019-06-18T19:53:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35248","text":"val Array(trainDF, testDF) = trainFiltered.randomSplit(Array(0.8, 0.2))","dateUpdated":"2019-06-18T19:55:54+0000","dateFinished":"2019-06-18T19:55:57+0000","dateStarted":"2019-06-18T19:55:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Passanger: smallint, Survived: smallint ... 10 more fields]\ntestDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Passanger: smallint, Survived: smallint ... 10 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560887754660_-2088808322","id":"20190618-195554_725521630","dateCreated":"2019-06-18T19:55:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35345","text":"println(s\"Train rows: ${trainDF.count}\\nTest rows: ${testDF.count}\")","dateUpdated":"2019-06-18T19:56:37+0000","dateFinished":"2019-06-18T19:56:47+0000","dateStarted":"2019-06-18T19:56:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Train rows: 708\nTest rows: 158\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1438","http://172.17.0.2:4040/jobs/job?id=1439"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560888011743_-1544751598","id":"20190618-200011_186453288","dateCreated":"2019-06-18T20:00:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35571","text":"val predictions = pipeline\n    .fit(trainDF)\n    .transform(testDF)","dateUpdated":"2019-06-18T20:00:28+0000","dateFinished":"2019-06-18T20:00:55+0000","dateStarted":"2019-06-18T20:00:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions: org.apache.spark.sql.DataFrame = [Sex: string, Passanger: smallint ... 21 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1440","http://172.17.0.2:4040/jobs/job?id=1441","http://172.17.0.2:4040/jobs/job?id=1442","http://172.17.0.2:4040/jobs/job?id=1443","http://172.17.0.2:4040/jobs/job?id=1444","http://172.17.0.2:4040/jobs/job?id=1445","http://172.17.0.2:4040/jobs/job?id=1446","http://172.17.0.2:4040/jobs/job?id=1447","http://172.17.0.2:4040/jobs/job?id=1448","http://172.17.0.2:4040/jobs/job?id=1449","http://172.17.0.2:4040/jobs/job?id=1450","http://172.17.0.2:4040/jobs/job?id=1451"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560887797737_-717849255","id":"20190618-195637_1593057822","dateCreated":"2019-06-18T19:56:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35442","text":"val modelEvaluator = new ComputeModelStatistics()\n    .setLabelCol(\"Survived\")\n    .setScoresCol(\"predictedProb\")\n    .setScoredLabelsCol(\"predictedLabel\")\n    .setEvaluationMetric(MetricConstants.ClassificationMetrics)","dateUpdated":"2019-06-18T20:26:37+0000","dateFinished":"2019-06-18T20:26:38+0000","dateStarted":"2019-06-18T20:26:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"modelEvaluator: com.microsoft.ml.spark.ComputeModelStatistics = ComputeModelStatistics_432a42f410b7\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560888684509_854767086","id":"20190618-201124_610036233","dateCreated":"2019-06-18T20:11:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35891","text":"modelEvaluator\n    .transform(predictions)\n    .select(\"accuracy\", \"precision\", \"recall\", \"AUC\")\n    .show","dateUpdated":"2019-06-18T20:30:34+0000","dateFinished":"2019-06-18T20:30:36+0000","dateStarted":"2019-06-18T20:30:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+------------------+------------------+------------------+\n|          accuracy|         precision|            recall|               AUC|\n+------------------+------------------+------------------+------------------+\n|0.8037974683544303|0.7258064516129032|0.7627118644067796|0.8461736004108891|\n+------------------+------------------+------------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1516","http://172.17.0.2:4040/jobs/job?id=1517","http://172.17.0.2:4040/jobs/job?id=1518","http://172.17.0.2:4040/jobs/job?id=1519","http://172.17.0.2:4040/jobs/job?id=1520","http://172.17.0.2:4040/jobs/job?id=1521","http://172.17.0.2:4040/jobs/job?id=1522","http://172.17.0.2:4040/jobs/job?id=1523","http://172.17.0.2:4040/jobs/job?id=1524"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560889761578_861129841","id":"20190618-202921_1124651057","dateCreated":"2019-06-18T20:29:21+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:38476"}],"name":"MMLSpark","id":"2EG1SK9FE","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}